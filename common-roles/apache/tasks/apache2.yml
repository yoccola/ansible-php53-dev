---

- name: Install Apache2 modules (RedHat).
  yum: >
    name={{ item }}
    state=installed
  with_items: apache_packages
  notify: restart webserver
  when: ansible_os_family == 'RedHat'
 
- name: Install Apache2 modules (Debian).
  apt: >
    name={{ item }}
    state=installed
    #pkg: "{{ item }}"
    #state: latest
  with_items: apache_packages
  notify: restart webserver
  #notify: Restart apache
  when: ansible_os_family == 'Debian'

#- name: Enable apache2 modules
#  file:
#    src: "/etc/apache2/mods-available/{{ item }}"
#    dest: "/etc/apache2/mods-enabled/{{ item }}"
#    state: link
#  with_items: apache_modules
#  notify: Restart apache
#
#- name: Disable default apache site
#  file:
#    path: "/etc/apache2/sites-enabled/000-default"
#    state: absent
#  notify: Restart apache
#
#- name: Disable default-ssl apache site
#  file:
#    path: "/etc/apache2/sites-enabled/000-default-ssl"
#    state: absent
#  notify: Restart apache
#
#- name: Configure Apache ports
#  template:
#    src: apache2/ports.conf.j2
#    dest: /etc/apache2/ports.conf
#  notify: Restart apache
#
#- name: Tighten Apache security
#  copy:
#    src: apache2/security
#    dest: /etc/apache2/conf.d/security
#  notify: Restart apache
